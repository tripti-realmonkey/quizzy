<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon.png">
    <title>Quizzy Dashboard</title>
    <!-- chartist CSS -->
    <link href="assets/libs/chartist/dist/chartist.min.css" rel="stylesheet">
    <link href="assets/libs/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.css" rel="stylesheet">
    <link href="dist/css/style.css" rel="stylesheet">
    <!-- This page CSS -->
    <link href="dist/css/pages/dashboard1.css" rel="stylesheet">
    <link rel="stylesheet" href="dist/css/cropper.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-analytics.js"></script>
<script  src="https://www.gstatic.com/firebasejs/7.21.1/firebase-database.js"></script>
<script  src="https://www.gstatic.com/firebasejs/7.21.1/firebase-auth.js"></script>
<script  src="https://www.gstatic.com/firebasejs/7.21.1/firebase-storage.js"></script>
<script src="index.js"></script>
<script>
    
var url = window.location.href;
if(url.indexOf('?id=') != -1)
{
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');
    var ref=db.ref('questions/'+id);
    ref.on("value", function(snapshot) {
        console.log(snapshot.val());
        var question=snapshot.val();
        document.getElementById('datakey').value=id;
        document.getElementById('questioname').value=question.question;
       
        document.getElementById('questiontype').value=question.type;   
        document.getElementById('questionlevel').value=question.level;    
        $('#questiontype').formSelect();
        $('#questionlevel').formSelect();
        setTimeout(function(){
            $('#questiontags').val(question.tags);       
            $('#questiontags').formSelect();
            $('#questioncat').val(question.cats);       
            $('#questioncat').formSelect();

        },1700);
        if(question.type == "0" ){
            document.getElementById('imgsection').style.display="none";
            document.getElementById('videosection').style.display="none";
        }
        else if(question.type == "1" ){
            document.getElementById('imgsection').style.display="block";
            document.getElementById('videosection').style.display="none";
        }
        else if(question.type == "2" ){
            document.getElementById('imgsection').style.display="none";
            document.getElementById('videosection').style.display="block";
        }
       
      
        document.getElementById('timelimit').value=question.time;
        document.getElementById('questionpoints').value=question.points;
        document.getElementById('videourl').value=question.videourl;
         document.getElementById('selimgurl').value=question.imgurl;
            document.getElementById('filename').value=question.imgurl;
             document.getElementById('imgname').value=question.fileName;
            document.getElementById('responsive_img').setAttribute("src", question.imgurl);
            document.getElementById('responsive_img').style.display="block";
       
       

      //  var options1=Object.keys(question.key).length;   
     
        if(question.key != ""){            
            document.getElementById('multiplechoice').checked = true;  
            document.querySelector('.multipleoptions').style.display = "block";
            if(question.option1){
                document.getElementById('option1value').value=question.option1;
            }  
            if(question.option2){
                document.getElementById('option2value').value=question.option2;
            }  
            if(question.option3){
                document.getElementById('option3value').value=question.option3;
            }  
            if(question.option4){
                document.getElementById('option4value').value=question.option4;
            }  
            jQuery('.correctvalue').prop('checked', false);      
            document.querySelector("input[type='checkbox'][class='correctvalue'][value='"+question.key+"']").checked=true;
           // console.log(question.answerkey);           
        }

        var datakey=document.getElementById('datakey').value;

        document.addEventListener('submit',function(e){
  e.preventDefault();
  
  


  var ref=db.ref('questions');

 
  
   var totalQuestions=0;
   ref.once("value")
   .then(function(snapshot) { 
    if (snapshot.hasChild(datakey)) {
        updateQuestion(datakey);
    }
  
    function updateQuestion(num){

      if (snapshot.hasChild(num)) {
  
        var qname=document.getElementById('questioname').value;
      var type=document.getElementById('questiontype').value;
      var level=document.getElementById('questionlevel').value;
      var tags=getSelectValues(document.getElementById('questiontags'));
      var cats=getSelectValues(document.getElementById('questioncat'));
      var timelimit=document.getElementById('timelimit').value;
      var points=document.getElementById('questionpoints').value;
      var multiplechoice=document.getElementById('multiplechoice');
      var videourl=document.getElementById('videourl').value;
        var filename=document.getElementById('filename').value;
        var imgname=document.getElementById('imgname').value;
      if(multiplechoice.checked == true){
        var option1=document.getElementById('option1value').value;
        var option2=document.getElementById('option2value').value;
        var option3=document.getElementById('option3value').value;
        var option4=document.getElementById('option4value').value;
        var selcted=document.querySelector('.correctvalue:checked').value;
        ref.child(num+'/key').set(selcted);
         ref.child(num+'/option1').set(option1);
            ref.child(num+'/option2').set(option2);
            ref.child(num+'/option3').set(option3);
            ref.child(num+'/option4').set(option4);
       // ref.child(num+'/options').set({option1:option1,option2:option2,option3:option3,option4:option4});
      }
  

         ref.child(num+'/question').set(qname);     
         
         ref.child(num+'/tags').set(tags);
         ref.child(num+'/cats').set(cats);
         ref.child(num+'/time').set(timelimit);
         ref.child(num+'/level').set(level);
         ref.child(num+'/type').set(type);
         ref.child(num+'/points').set(points);
         ref.child(num+'/videourl').set(videourl);
            ref.child(num+'/imgurl').set(filename);
            ref.child(num+'/fileName').set(imgname);
        ref.child(num+'/updated_at').set(Math.round(new Date().getTime()/1000));

        var currentdate = new Date(); 
        var datetime =  currentdate.getDate() + "/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getFullYear() + " @ "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes();       
      //  ref.child(num+'updated_at').set(Math.round(new Date().getTime()/1000));
         document.getElementById("smessage").innerHTML ="Updated Successfully!";
         setTimeout(function(){
            document.getElementById("smessage").innerHTML ="";
         },2000);
      }
    }

  });

    
}, function (errorObject) {
        
   

});

});
}
else{
    document.addEventListener('DOMContentLoaded', function(){ 
        document.getElementById('imgsection').style.display="none";
        document.getElementById('videosection').style.display="none";
    }, false);
   
    document.addEventListener('submit',function(e){
    e.preventDefault();
    


    var ref=db.ref('questions');

    
    
    var totalQuestions=0;
    ref.once("value")
    .then(function(snapshot) {
        totalQuestions=parseInt(snapshot.numChildren())+parseInt(1); 
        if (snapshot.hasChild('Questions'+totalQuestions)) {
        var cond=1;
        do {       
            totalQuestions++;
            // console.log("question="+totalQuestions);
            if (!snapshot.hasChild('Questions'+totalQuestions)) { cond=0;
            // console.log('childadded'+totalQuestions);
            addQuestion(totalQuestions);
            }
        }
        while (cond == 1);      
        }
        else{
        addQuestion(totalQuestions);
        }
    
        function addQuestion(num){

        if (!snapshot.hasChild('Questions'+num)) {
    
            var qname=document.getElementById('questioname').value;
        var type=document.getElementById('questiontype').value;
        var level=document.getElementById('questionlevel').value;
        var tags=getSelectValues(document.getElementById('questiontags'));
        var cats=getSelectValues(document.getElementById('questioncat'));
        var timelimit=document.getElementById('timelimit').value;
        var points=document.getElementById('questionpoints').value;
        var videourl=document.getElementById('videourl').value;
        var filename=document.getElementById('filename').value;
        var imgname=document.getElementById('imgname').value;
        var multiplechoice=document.getElementById('multiplechoice');
        if(multiplechoice.checked == true){
            var option1=document.getElementById('option1value').value;
            var option2=document.getElementById('option2value').value;
            var option3=document.getElementById('option3value').value;
            var option4=document.getElementById('option4value').value;
            var selcted=document.querySelector('.correctvalue:checked').value;
            ref.child('Questions'+num+'/key').set(selcted);
            ref.child('Questions'+num+'/option1').set(option1);
            ref.child('Questions'+num+'/option2').set(option2);
            ref.child('Questions'+num+'/option3').set(option3);
            ref.child('Questions'+num+'/option4').set(option4);
            //ref.child('question'+num+'/options').set({option1:option1,option2:option2,option3:option3,option4:option4});
        }
    
            ref.child('Questions'+num+'/ID').set('Questions'+num);
            ref.child('Questions'+num+'/question').set(qname);
        
            
            ref.child('Questions'+num+'/tags').set(tags);
            ref.child('Questions'+num+'/cats').set(cats);
            ref.child('Questions'+num+'/time').set(timelimit);
            ref.child('Questions'+num+'/level').set(level);
            ref.child('Questions'+num+'/type').set(type);
            ref.child('Questions'+num+'/points').set(points);
            ref.child('Questions'+num+'/videourl').set(videourl);
            ref.child('Questions'+num+'/imgurl').set(filename);
            ref.child('Questions'+num+'/fileName').set(imgname);
             ref.child('Questions'+num+'/updated_at').set(Math.round(new Date().getTime()/1000));
            document.getElementById("smessage").innerHTML ="Added Successfully!";
            setTimeout(function(){
                document.getElementById("smessage").innerHTML ="";
                document.getElementById("add_question").reset();
                document.getElementById('responsive_img').style.display="none";
            },2000);
            
        }
        }

    })


    //setTimeout(function(){  document.getElementById("add_question").reset(); }, 2000);



    // console.log("name="+qname+"<br> type="+type+"<br> tags="+tags+" <br> limit="+timelimit+ "<br> points="+points+"<br> option1"+option1+"<br> selcted"+selcted);
    return false;
    });
}
</script>
</head>

<body>
    <div class="main-wrapper" id="main-wrapper">
        <!-- ============================================================== -->
        <!-- Preloader - style you can find in spinners.css -->
        <!-- ============================================================== -->
        <div class="preloader">
            <div class="loader">
                <div class="loader__figure"></div>
                <p class="loader__label"></p>
            </div>
        </div>
        <!-- ============================================================== -->
        <!-- Preloader - style you can find in spinners.css -->
        <!-- ============================================================== -->
        <header class="topbar">
            <!-- ============================================================== -->
            <!-- Navbar scss in header.scss -->
            <!-- ============================================================== -->
            <nav>
                <div class="nav-wrapper">
                    <!-- ============================================================== -->
                    <!-- Logo you can find that scss in header.scss -->
                    <!-- ============================================================== -->
                    <a href="javascript:void(0)" class="brand-logo">
                        <span class="icon">
                            <img class="light-logo" src="assets/images/logo-light-icon.png">
                            <img class="dark-logo" src="assets/images/logo-icon.png">
                        </span>
                        <span class="text">
                            <img class="light-logo" src="assets/images/logo-light-text.png">
                            <img class="dark-logo" src="assets/images/logo-text.png">
                        </span>
                    </a>
                  
                    <ul class="left">
                        <li class="hide-on-med-and-down">
                            <a href="javascript: void(0);" class="nav-toggle">
                                <span class="bars bar1"></span>
                                <span class="bars bar2"></span>
                                <span class="bars bar3"></span>
                            </a>
                        </li>
                        <li class="hide-on-large-only">
                            <a href="javascript: void(0);" class="sidebar-toggle">
                                <span class="bars bar1"></span>
                                <span class="bars bar2"></span>
                                <span class="bars bar3"></span>
                            </a>
                        </li>
                        
                    </ul>
                  
                    <ul class="right">
                        
                        
                        <li><a class="dropdown-trigger" href="javascript: void(0);" data-target="user_dropdown"><img src="assets/images/users/2.jpg" alt="user" class="circle profile-pic"></a>
                            <ul id="user_dropdown" class="mailbox dropdown-content dropdown-user">
                                <li>
                                    <div class="dw-user-box">
                                        <div class="u-img"><img src="assets/images/users/2.jpg" alt="user"></div>
                                        <div class="u-text">
                                            <h4>Steve Harvey</h4>
                                            <p>steve@gmail.com</p>
                                            <a href="profile.html" class="waves-effect waves-light btn-small red white-text">View Profile</a>
                                        </div>
                                    </div>
                                </li>
                                <li role="separator" class="divider"></li>
                                <li><a href="profile.html"><i class="material-icons">account_circle</i> My Profile</a></li>
                               <!--  <li><a href="#"><i class="material-icons">account_balance_wallet</i> My Balance</a></li>
                                <li><a href="#"><i class="material-icons">inbox</i> Inbox</a></li>
                                <li role="separator" class="divider"></li>
                                <li><a href="#"><i class="material-icons">settings</i> Account Setting</a></li> -->
                                <li role="separator" class="divider"></li>
                                <li><a href="login.html"><i class="material-icons">power_settings_new</i> Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                    <!-- ============================================================== -->
                    <!-- Right topbar icon scss in header.scss -->
                    <!-- ============================================================== -->
                </div>
            </nav>
            <!-- ============================================================== -->
            <!-- Navbar scss in header.scss -->
            <!-- ============================================================== -->
        </header>
        <!-- ============================================================== -->
        <!-- Sidebar scss in sidebar.scss -->
        <!-- ============================================================== -->
        <aside class="left-sidebar">
            <ul id="slide-out" class="sidenav">
                <li>
                    <ul class="collapsible">
                     <!--    <li class="small-cap"><span class="hide-menu">PERSONAL</span></li> -->
                        <li>
                            <a href="index.html" class="collapsible-header"><i class="material-icons">dashboard</i><span class="hide-menu"> Dashboard</span></a>
                           
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="collapsible-header has-arrow"><i class="material-icons">apps</i><span class="hide-menu"> Quiz Management</span></a>                            
                            <div class="collapsible-body">
                                <ul>
                                    <li><a href="#addquizmodal" class="modal-trigger"><i class="material-icons">assignment</i><span class="hide-menu">Add New</span></a></li>
                                    <li><a href="quiz.html"><i class="material-icons">assignment</i><span class="hide-menu">Quiz</span></a></li>
                                 </ul>
                            </div>
                        </li>
                        <li>
                            <a href="users.html" class="collapsible-header"><i class="material-icons">group</i><span class="hide-menu"> User Management</span></a>
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="collapsible-header has-arrow"><i class="material-icons">receipt</i><span class="hide-menu"> Categories</span></a>                            
                            <div class="collapsible-body">
                                <ul>
                                    <li><a href="addcat.html"><i class="material-icons">receipt</i><span class="hide-menu">Add New</span></a></li>
                                    <li><a href="categories.html"><i class="material-icons">receipt</i><span class="hide-menu">Categories</span></a></li>
                                 </ul>
                            </div>
                        </li>
                        <li>
                            <a href="javascript: void(0);" class="collapsible-header has-arrow"><i class="material-icons">assignment</i><span class="hide-menu"> Tags</span></a>                            
                            <div class="collapsible-body">
                                <ul>
                                    <li><a href="addtag.html"><i class="material-icons">assignment</i><span class="hide-menu">Add Tag</span></a></li>
                                    <li><a href="tags.html"><i class="material-icons">assignment</i><span class="hide-menu">Tags</span></a></li>
                                 </ul>
                            </div>
                        </li>
						<li>
                            <a href="javascript: void(0);" class="collapsible-header has-arrow"><i class="material-icons">equalizer</i><span class="hide-menu"> Question Bank</span></a>                            
                            <div class="collapsible-body">
                                <ul>
                                    <li><a href="addquestion.html"><i class="material-icons">adjust</i><span class="hide-menu">Add new Question</span></a></li>
                                    <li><a href="questions.html"><i class="material-icons">adjust</i><span class="hide-menu">Questions</span></a></li>
                                 </ul>
                            </div>
                        </li>
                        <!-- <li>
                            <a href="../docs/documentation.html" class="collapsible-header"><i class="material-icons">content_paste</i><span class="hide-menu"> Documentation </span></a>
                        </li> -->
                        <li>
                            <a href="leaderboard.html" class="collapsible-header"><i class="material-icons">directions</i><span class="hide-menu"> Leaderboard </span></a>
                        </li>
                       <!--  <li>
                            <a href="faqs.html" class="collapsible-header"><i class="material-icons">people_outline</i><span class="hide-menu"> FAQs </span></a>
                        </li> -->
                    </ul>
                </li>
            </ul>
        </aside>
        <!-- ============================================================== -->
        <!-- Sidebar scss in sidebar.scss -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Page wrapper scss in scafholding.scss -->
        <!-- ============================================================== -->
        <div class="page-wrapper">
            <!-- ============================================================== -->
            <!-- Title and breadcrumb -->
            <!-- ============================================================== -->
            <div class="page-titles">
                <div class="d-flex align-items-center">
                    <h5 class="font-medium m-b-0">Dashboard</h5>
                    <div class="custom-breadcrumb ml-auto">
                        <a href="#!" class="breadcrumb">Questions</a>
                        <a href="#!" class="breadcrumb">Add new</a>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <div class="container-fluid">
                <div class="row">
                    <div class="col s12">
                        <div class="card">
                            
                            <form class="h-form" id="add_question" method="post"  enctype="multipart/form-data">

                                <input type="hidden" id="datakey" name="datakey" />
                                <div class="form-body">
                                    <div class="divider"></div>
                                    <div class="card-content">                                       
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questioname">Question</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <input id="questioname" name="questioname" type="text" placeholder="Type your Question Here" required />
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questionlevel">Question Level</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field col s12">
                                                    <select id="questionlevel" name="questionlevel" required>
                                                        <option value="Hard">Hard</option>
                                                        <option value="Tricky">Tricky</option>
                                                        <option value="Easy">Easy</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questiontype">Question Type</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field col s12">
                                                    <select id="questiontype" name="questiontype" required>
                                                        <option value="0" selected>Text</option>
                                                        <option value="1">Image</option>
                                                        <option value="2">Video</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questiontags">Choose Tags</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field col s12">
                                                    
                                                       <script>
                                                        var tags=db.ref('tags');
                                                        tags.orderByValue().on("value", function(snapshot) {
                                                            var html='';
                                                            questiontags = document.getElementById('questiontags');
                                                            snapshot.forEach(function(data) {
                                                                questiontags.options[questiontags.options.length] = new Option(data.val().tag, data.val().tag);
                                                                                                                         
                                                            });
                                                        });
                                                        document.addEventListener('DOMContentLoaded', function(){ 
                                                            setTimeout(function(){
                                                                $('#questiontags').formSelect();
                                                            },1500);
                                                        });
                                                       
                                                       </script>
                                                       <p><a class="waves-effect waves-light btn modal-trigger" href="#modal1"><i class="material-icons dp48">add</i> Add New Tag</a></p>
                                                       <select multiple id="questiontags" name="questiontags" required></select>
                                                       
                                                       <div id="modal1" class="modal">
                                                        <div class="modal-content">
                                                          <h4>Add New Tag</h4>
                                                          <div class="row">
                                                              <div class="row">
                                                                <div class="input-field col s12">
                                                                  <input placeholder="Tag" id="newtag" type="text" class="validate">                                                                  
                                                                </div>                                                                
                                                              </div>                                                            
                                                              
                                                              <div class="row">
                                                                <div class="col s12">                                                                 
                                                                    <div class="card-content">
                                                                        <div class="form-action">
                                                                            <button class="btn cyan waves-effect waves-light" type="submit" id="addtagbtn">Save
                                                                            </button>                                                                           
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                              </div>

                                                              <script>
                                                                  document.getElementById("addtagbtn").addEventListener('click',function(e){
                                                                      var tag=document.getElementById('newtag').value;
                                                                      var ref=db.ref('tags');
                                                                      if(tag != ""){
                                                                        var totalTags=0;
                                                                        ref.once("value")
                                                                        .then(function(snapshot) {
                                                                            totalTags=parseInt(snapshot.numChildren())+parseInt(1); 
                                                                            if (snapshot.hasChild('tag'+totalTags)) {
                                                                            var cond=1;
                                                                            do {       
                                                                                totalTags++;
                                                                                if (!snapshot.hasChild('tag'+totalTags)) { cond=0;
                                                                                addTag(totalTags);
                                                                                }
                                                                            }
                                                                            while (cond == 1);      
                                                                            }
                                                                            else{
                                                                                addTag(totalTags);
                                                                            }
                                                                        
                                                                            function addTag(num){

                                                                                if (!snapshot.hasChild('tag'+num)) {
                                                                            
                                                                                    var qname=document.getElementById('newtag').value; 
                                                                                    ref.child('tag'+num+'/tag').set(qname);
                                                                                    var questiontags= document.getElementById('questiontags');
                                                                                    questiontags.options[questiontags.options.length] = new Option(qname, qname);
                                                                                    $('#questiontags').formSelect();

                                                                                    document.getElementById("tagmsg").innerHTML ="Added Successfully!";
                                                                                    setTimeout(function(){
                                                                                        document.getElementById("tagmsg").innerHTML ="";
                                                                                        document.getElementById("newtag").value='';
                                                                                        document.getElementById("closemodel").click();
                                                                                    },2000);
                                                                                    
                                                                                }
                                                                             }

                                                                        });
                                                                    }
                                                                  })
                                                              </script>
                                                              <p id="tagmsg"></p>
                                                          </div>
                                                        </div>
                                                        <div class="modal-footer">
                                                          <a href="#!" id="closemodel" class="modal-close waves-effect waves-green btn-flat">Close</a>
                                                        </div>
                                                      </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questioncat">Choose Category</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field col s12">
                                                    
                                                       <script>
                                                        var tags=db.ref('categories');
                                                        tags.orderByValue().on("value", function(snapshot) {
                                                            var html='';
                                                            questioncat = document.getElementById('questioncat');
                                                            snapshot.forEach(function(data) {
                                                                questioncat.options[questioncat.options.length] = new Option(data.val().cat, data.val().cat);
                                                                                                                           
                                                            });
                                                        });
                                                        document.addEventListener('DOMContentLoaded', function(){ 
                                                            setTimeout(function(){
                                                                $('#questioncat').formSelect();
                                                            },1500);
                                                        });
                                                       
                                                       </script>
                                                       <select multiple id="questioncat" name="questioncat" required></select>
                                                       
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row" id="imgsection">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questionfile">Upload Image</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="file-field input-field">
                                                    <div class="btn grey">
                                                      <span>File</span>
                                                      <input name="myImage" id="selimg" type="file">
                                                    </div>
                                                    <div class="file-path-wrapper">
                                                      <input class="file-path validate" id="selimgurl" type="text">
                                                    </div>
                                                  </div>
                                                  <img src="" id="responsive_img" style="display: none;width:150px;">
                                                  <img id="croppartimg11" src="" /> 
                                                  
                                                  <div id="mycropModal" class="modal fade" role="dialog">
                                                    <div class="modal-dialog">
                                                  
                                                      <!-- Modal content-->
                                                      <div class="modal-content">
                                                        <div class="modal-body">
                                                          <img id="croppartimg" src="" />
                                                          <button type="button" id="button">Crop</button>
                                                          <span id="cropBoxData"></span>
                                                          <div id="result"></div>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
                                                        </div>
                                                      </div>
                                                  
                                                    </div>
                                                  </div>

                                                  <script src="dist/js/cropper.js"></script>
                                                  <script>
                                                    window.addEventListener('DOMContentLoaded', function () {
                                                      
                                                    });
                                                  </script>
                                            </div>
                                        </div>
                                        <div class="row" id="videosection">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="videourl">Video URL</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field">
                                                    <input id="videourl" name="videourl" type="text" value="" >
                                                   
                                                </div>
                                            </div>
                                        </div>                                   
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="timelimit">Time Limit (Seconds)</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field">
                                                    <input id="timelimit" name="timelimit" type="number" value="" required>
                                                   
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label for="questionpoints">Points</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="input-field">
                                                    <input id="questionpoints" name="questionpoints" type="range" min="100" max="5000" step="100">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s3">
                                                <div class="h-form-label">
                                                    <label>Multiple Choice?</label>
                                                </div>
                                            </div>
                                            <div class="input-field col s9">
                                                <div class="switch">
                                                    <label>
                                                        No
                                                        <input type="checkbox" name="multiplechoice" id="multiplechoice">
                                                        <span class="lever"></span>
                                                        Yes
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row multipleoptions" style="display:none;">                                            
                                            <div class="input-field col s6">
                                                <div class="input-field col s11">
                                                    <input id="option1value" name="option1value" type="text" placeholder="Option 1">                                                    
                                                </div>
                                                <div class="input-field col s1">
                                                    <label>
                                                        <input name="group1" class="correctvalue" type="checkbox" checked=""  value="option1">
                                                        <span> </span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="input-field col s6">
                                                <div class="input-field col s11">
                                                    <input id="option2value" name="option2value" type="text" placeholder="Option 2">                                                    
                                                </div>
                                                <div class="input-field col s1">
                                                    <label>
                                                        <input name="group1" class="correctvalue" type="checkbox"  value="option2">
                                                        <span> </span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="input-field col s6">
                                                <div class="input-field col s11">
                                                    <input  id="option3value" name="option3value" type="text" placeholder="Option 3">                                                    
                                                </div>
                                                <div class="input-field col s1">
                                                    <label>
                                                        <input name="group1" class="correctvalue" type="checkbox"  value="option3">
                                                        <span> </span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="input-field col s6">
                                                <div class="input-field col s11">
                                                    <input  id="option4value" name="option4value" type="text" placeholder="Option 4">                                                    
                                                </div>
                                                <div class="input-field col s1">
                                                    <label>
                                                        <input name="group1" class="correctvalue" type="checkbox" value="option4">
                                                        <span> </span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="divider"></div>
                                    <div class="card-content">
                                        <div class="form-action">
                                            <input type="hidden" id="filename" />
                                            <input type="hidden" id="imgname" />
                                            <button class="btn cyan waves-effect waves-light" type="submit" name="action">Save
                                            </button>
                                            <button class="btn waves-effect waves-light grey darken-4" type="submit" name="action">Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>

                           
                              


                              <script>
                                  var imgName, imgUrl;
                                  var files=[];
                                 // var reader= new FileReader();
                                    

                                 document.getElementById('videourl').onchange=function(e){
                                        var video= document.getElementById('videourl').value;
                                        if(video != ""){
                                            document.getElementById('selimg').value='';
                                            document.getElementById('selimgurl').value='';
                                            document.getElementById('filename').value='';
                                                document.getElementById('responsive_img').setAttribute("src", '');
                                                document.getElementById('responsive_img').style.display="block";
                                        }
                                 } 

                                 document.getElementById('questiontype').onchange=function(e){
                                        var type= document.getElementById('questiontype').value;
                                        if(type == "0"){
                                            document.getElementById('selimg').value='';
                                            document.getElementById('selimgurl').value='';
                                            document.getElementById('filename').value='';
                                            document.getElementById('responsive_img').setAttribute("src", '');
                                            document.getElementById('imgsection').style.display="none";
                                            document.getElementById('videosection').style.display="none";
                                        }
                                        else  if(type == "1"){
                                            document.getElementById('imgsection').style.display="block";
                                            document.getElementById('videosection').style.display="none";
                                        }
                                        else  if(type == "2"){
                                            document.getElementById('imgsection').style.display="none";
                                            document.getElementById('videosection').style.display="block";
                                        }
                                 } 

                                  document.getElementById('selimg').onchange=function(e){
                                      e.preventDefault;
                                      var storageRef = firebase.storage().ref();
                                      var file = document.getElementById("selimg").files[0];
                                       // console.log(file);
                                       var imgname=new Date().getTime()+file.name;
                                      
                                       $('#mycropModal').modal();

                                        $('#mycropModal').modal('open'); 
                                       $('#cropimagebtn').click();
                                       $("#croppartimg").attr('src',URL.createObjectURL(e.target.files[0]));
                                       var image = document.querySelector('#croppartimg');
                                                      var cropBoxData = document.querySelector('#cropBoxData');
                                                      var button = document.getElementById('button');
                                                      var result = document.getElementById('result');
                                                      var cropper = new Cropper(image, {
                                                        ready: function (event) {
                                                          // Zoom the image to its natural size
                                                          cropper.zoomTo(1);
                                                        },
                                                
                                                        crop: function (event) {
                                                          cropBoxData.textContent = JSON.stringify(cropper.getCropBoxData());
                                                        },
                                                
                                                        zoom: function (event) {
                                                          // Keep the image in its natural size
                                                          if (event.detail.oldRatio === 1) {
                                                            event.preventDefault();
                                                          }
                                                        },
                                                      });
                                                
                                                      button.onclick = function () {
                                                        result.innerHTML = '';
                                                        result.appendChild(cropper.getCroppedCanvas());
                                                        let data = cropper.getCroppedCanvas().toDataURL('image/jpeg');
                                                        console.log(data);

                                                        var storageRef = firebase.storage().ref();
                                                        var imgname=new Date().getTime();
                                                        var thisRef = storageRef.child(imgname+file.name);
                                                        thisRef.putString(data, 'data_url').then(function(snapshot) {
                                                        console.log('Uploaded a data_url string!');
                                                        snapshot.ref.getDownloadURL().then(function(url){
                                                            
                                                                 document.getElementById('filename').value=url;
                                                                document.getElementById('imgname').value=imgname+file.name;
                                                                document.getElementById('responsive_img').setAttribute("src", url);
                                                                 document.getElementById('responsive_img').style.display="block";
                                                                 //document.getElementById('videosection').style.display="none";
                                                                document.getElementById('videourl').value='';
                                                            })
                                                        });
                                                      };
                                        //         var thisRef = storageRef.child(imgname.trim());

                                        
                                        // thisRef.put(file).then(function(snapshot) {
                                        //     snapshot.ref.getDownloadURL().then(function(url){

                                        //         document.getElementById('filename').value=url;
                                        //         document.getElementById('imgname').value=imgname+file.name;
                                        //         document.getElementById('responsive_img').setAttribute("src", url);
                                        //         document.getElementById('responsive_img').style.display="block";
                                        //         //document.getElementById('videosection').style.display="none";
                                        //         document.getElementById('videourl').value='';
                                        //     })
                                         
                                        // });
                                    //   alert('dsd');
                                    //   files=e.target.files;
                                    //   reader= new FileReader();
                                    //   reader.onload = function(){
                                    //       alert(reader.result);
                                    //   }
                                    //   alert(files[0]);
                                  }

                              </script>

                            <p id="smessage"></p>
                           
                        </div>
                    </div>
                    
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- Modal Structure -->
            <div id="addquizmodal" class="modal">
                <div class="modal-content">
                <h4>Standard Quiz Details</h4>
                <div class="divider"></div>
                <div class="card-content">                                       
                    <div class="row">
                        <div class="col s3">
                            <div class="h-form-label">
                                <label for="quiztitle">Quiz Title</label>
                            </div>
                        </div>
                        <div class="input-field col s9">
                            <input id="quiztitle" name="quiztitle" type="text" placeholder="Quiz Title" required />
                        </div>
                    </div>
                </div>
                <div class="card-content">                                       
                    <div class="row">
                        <div class="col s3">
                            <div class="h-form-label">
                                <label for="quizdesc">Quiz Description</label>
                            </div>
                        </div>
                        <div class="input-field col s9">
                            <textarea id="quizdesc" name="quizdesc" type="text" placeholder="" required ></textarea>
                        </div>
                    </div>
                </div>
                <div class="divider"></div>
                <div class="card-content">
                    <div class="form-action">
                        <button class="btn cyan waves-effect waves-light" type="submit" id="submitquiz">Save
                        </button>
                    </div>
                </div>
                <p id="Quizmsg"></p>
                </div>
                <div class="modal-footer">
                <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
                </div>
            </div> 
        </div>
        <script>
           document.getElementById("submitquiz").addEventListener('click',function(e){
                var title=$('#quiztitle').val();
                var desc=$('#quizdesc').val();
                var ref=db.ref('quiz');    
    
                var totalTags=0;
                ref.once("value")
                .then(function(snapshot) {
                    totalTags=parseInt(snapshot.numChildren())+parseInt(1); 
                    if (snapshot.hasChild('quiz'+totalTags)) {
                    var cond=1;
                    do {       
                        totalTags++;
                        if (!snapshot.hasChild('quiz'+totalTags)) { cond=0;
                            addQuiz(totalTags);
                        }
                    }
                    while (cond == 1);      
                    }
                    else{
                        addQuiz(totalTags);
                    }                
                    function addQuiz(num){

                    if (!snapshot.hasChild('quiz'+num)) {
                
                        var title=document.getElementById('quiztitle').value;   
                        var desc=document.getElementById('quizdesc').value;   
                        ref.child('quiz'+num+'/title').set(title);
                        ref.child('quiz'+num+'/desc').set(desc);
                        document.getElementById("Quizmsg").innerHTML ="Added Successfully!";
                        setTimeout(function(){
                            document.getElementById("Quizmsg").innerHTML ="";
                            document.getElementById("quiztitle").value='';
                            document.getElementById("quizdesc").value='';
                            location.href = "/questions.html?qid="+'quiz'+num;
                        },2000);
                        
                    }
                    }

                })
            });

        </script>
        <!-- ============================================================== -->
        <!-- Page wrapper scss in scafholding.scss -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Right Sidebar -->
        <!-- ============================================================== -->
		
        <!-- ============================================================== -->
        <!-- Right Sidebar -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- All Required js -->
    <!-- ============================================================== -->
    <script src="assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="dist/js/materialize.min.js"></script>
    <script src="assets/libs/perfect-scrollbar/dist/js/perfect-scrollbar.jquery.min.js"></script>

    

    <!-- ============================================================== -->
    <!-- Apps -->
    <!-- ============================================================== -->
    <script src="dist/js/app.js"></script>
    <script src="dist/js/core.js"></script>
    <script src="dist/js/app.init.dark.js"></script>
    <script src="dist/js/app-style-switcher.js"></script>
    <!-- ============================================================== -->
    <!-- Custom js -->
    <!-- ============================================================== -->
    <script src="dist/js/custom.min.js"></script>
    <!-- ============================================================== -->
    <!-- This page plugin js -->
    <!-- ============================================================== -->
    <script src="assets/libs/chartist/dist/chartist.min.js"></script>
    <script src="assets/libs/chartist-plugin-tooltips/dist/chartist-plugin-tooltip.min.js"></script>
    <script src="assets/extra-libs/sparkline/sparkline.js"></script>
    <script src="dist/js/pages/dashboards/dashboard1.js"></script>
</body>
</html>